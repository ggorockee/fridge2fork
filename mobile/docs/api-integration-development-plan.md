# 냉털레시피 API 연동 개발 계획서

## 📋 프로젝트 개요

### 목적
냉장고에 있는 재료를 기반으로 한식 레시피를 추천하는 Flutter 모바일 앱 개발
- **핵심 기능**: 재료 입력 → 유사도 기반 레시피 추천
- **대상**: MVP 개발, 회원가입 없는 세션 기반 운영
- **우선순위**: 기능 동작 우선, 추후 개인화 기능 확장

### 현재 상황
- ✅ API 서버 개발 완료 (`https://api-dev.woohalabs.com`)
- ✅ Flutter 프로젝트 기본 구조 완성
- ✅ Firebase/AdMob 설정 완료
- ✅ 환경 설정 및 API 클라이언트 준비 완료

---

## 🔗 API 분석 결과

### 주요 엔드포인트
| 기능 | Method | URL | 설명 |
|------|--------|-----|------|
| 랜덤 레시피 추천 | GET | `/fridge2fork/v1/recipes/random-recommendations` | 세션 기반 랜덤 추천 |
| 재료 목록 조회 | GET | `/fridge2fork/v1/fridge/ingredients` | 전체 재료 검색 |
| 재료 추가 | POST | `/fridge2fork/v1/fridge/ingredients` | 냉장고 재료 추가 |
| 재료 삭제 | DELETE | `/fridge2fork/v1/fridge/ingredients` | 냉장고 재료 삭제 |
| 내 재료 목록 | GET | `/fridge2fork/v1/fridge/my-ingredients` | 세션별 재료 조회 |
| 재료 기반 레시피 | GET | `/fridge2fork/v1/recipes/by-fridge` | 유사도순 레시피 추천 |
| 카테고리 목록 | GET | `/fridge2fork/v1/fridge/categories` | 재료 카테고리 목록 |
| 레시피 상세 | GET | `/fridge2fork/v1/recipes/{rcp_sno}` | 개별 레시피 정보 |

### 세션 관리
- **session_id** 기반 상태 관리 (회원가입 없음)
- 클라이언트에서 UUID 생성하여 API 호출시 전달
- SharedPreferences로 세션 영속성 관리

---

## 📅 Phase별 개발 계획

### Phase 1: 기초 인프라 구축
**목표**: API 연동 기반 시스템 구축
**예상 기간**: 2-3일

#### 작업 항목
- [ ] 세션 관리 시스템 구현
  - [ ] UUID 기반 session_id 생성
  - [ ] SharedPreferences 영속성 관리
  - [ ] 세션 만료 처리 로직
- [ ] API 클라이언트 업데이트
  - [ ] 실제 API URL 연동 (`https://api-dev.woohalabs.com`)
  - [ ] 세션 헤더 자동 추가
  - [ ] 오류 처리 및 재시도 로직 개선
- [ ] Provider 구조 개선
  - [ ] API 기반 상태 관리로 전환
  - [ ] 오프라인 모드 fallback 유지

**완료 조건**: API 연결 테스트 성공, 세션 관리 동작 확인

---

### Phase 2: 홈 화면 API 연동
**목표**: 랜덤 레시피 추천 및 재료 추가 기능 구현
**예상 기간**: 3-4일

#### 작업 항목
- [ ] 랜덤 레시피 추천 구현
  - [ ] `/recipes/random-recommendations` API 연동
  - [ ] 10개 레시피 랜덤 표시
  - [ ] 새로고침시 다른 레시피 로드
  - [ ] 로딩 상태 및 에러 처리
- [ ] 재료 추가 기능 개선
  - [ ] `/fridge/ingredients` GET API로 재료 검색
  - [ ] `/fridge/ingredients` POST API로 재료 추가
  - [ ] 검색 성능 최적화 (debounce 적용)
- [ ] UI/UX 개선
  - [ ] 빈 냉장고 상태 표시 개선
  - [ ] 재료 추가 완료시 피드백 제공
  - [ ] 추천 레시피 카드 디자인 보완

**완료 조건**: 홈 화면에서 재료 추가 → 랜덤 레시피 10개 표시 동작

---

### Phase 3: 내 냉장고 화면 구현
**목표**: API 기반 재료 관리 및 카테고리 표시
**예상 기간**: 2-3일

#### 작업 항목
- [ ] 내 재료 목록 API 연동
  - [ ] `/fridge/my-ingredients` API로 재료 목록 로드
  - [ ] 세션별 재료 관리
  - [ ] 실시간 동기화
- [ ] 카테고리 시스템 구현
  - [ ] `/fridge/categories` API로 동적 카테고리 로드
  - [ ] 카테고리별 재료 그룹핑 표시
  - [ ] 카테고리 필터링 기능
- [ ] 재료 삭제 기능
  - [ ] `/fridge/ingredients` DELETE API 연동
  - [ ] 개별 재료 삭제
  - [ ] 전체 재료 삭제 옵션

**완료 조건**: 내 냉장고에서 카테고리별 재료 표시, 삭제 기능 동작

---

### Phase 4: 요리하기 기능 구현
**목표**: 냉장고 재료 기반 레시피 추천
**예상 기간**: 3-4일

#### 작업 항목
- [ ] 재료 기반 레시피 조회
  - [ ] `/recipes/by-fridge` API 연동
  - [ ] 세션 기반 재료 자동 전달
  - [ ] 유사도순 정렬 (similarity 기본)
- [ ] 레시피 목록 화면 구현
  - [ ] 레시피 카드 리스트 표시
  - [ ] 이미지, 타이틀, 요리시간 정보
  - [ ] 무한 스크롤 또는 페이징 처리
- [ ] 레시피 상세 화면 구현
  - [ ] `/recipes/{rcp_sno}` API 연동
  - [ ] 상세 정보, 재료 목록, 조리법 표시
  - [ ] 외부 링크 연결 (url_launcher 활용)

**완료 조건**: 내 냉장고 재료로 유사 레시피 목록 표시 및 상세 보기

---

### Phase 5: 의견 보내기 기능 구현
**목표**: 사용자 피드백 수집 시스템
**예상 기간**: 2일

#### 작업 항목
- [ ] 의견 보내기 화면 구현
  - [ ] 식재료 추가 요청 폼
  - [ ] 레시피 추가 요청 폼
  - [ ] 일반 의견 보내기 폼
- [ ] 피드백 전송 기능
  - [ ] 이메일 기반 전송 (mailto 또는 서버 API)
  - [ ] 전송 완료 피드백 제공
  - [ ] 입력 검증 및 에러 처리

**완료 조건**: 3가지 유형의 의견 전송 기능 완성

---

### Phase 6: AdMob 광고 통합
**목표**: 정책 준수 광고 전략 구현
**예상 기간**: 2-3일

#### 작업 항목
- [ ] 광고 전략 구현
  - [ ] 전면 광고: 레시피 상세 보기 완료 후
  - [ ] 배너 광고: 홈 화면 하단, 내 냉장고 하단
  - [ ] 자연스러운 광고 타이밍 조정
- [ ] 사용자 경험 최적화
  - [ ] 과도한 광고 방지 (세션당 전면 광고 3회 제한)
  - [ ] 가치 제공 후 광고 노출 원칙
  - [ ] 광고 로딩 실패시 처리
- [ ] 성능 최적화
  - [ ] 광고 프리로딩
  - [ ] 메모리 사용량 모니터링

**완료 조건**: 앱 사용성을 해치지 않는 자연스러운 광고 노출

---

### Phase 7: 최종 검증 및 배포 준비
**목표**: 품질 확보 및 배포 준비
**예상 기간**: 2-3일

#### 작업 항목
- [ ] 전체 기능 테스트
  - [ ] 각 화면별 기능 검증
  - [ ] API 연동 상태 확인
  - [ ] 오프라인 모드 테스트
- [ ] 성능 최적화
  - [ ] 메모리 누수 체크
  - [ ] 네트워크 요청 최적화
  - [ ] 앱 시작 속도 개선
- [ ] 배포 준비
  - [ ] 프로덕션 환경 설정
  - [ ] Firebase 설정 검증
  - [ ] 스토어 등록 준비

**완료 조건**: MVP 기능 완전 동작, 배포 가능 상태

---

## 📱 AdMob 광고 전략

### 정책 준수 원칙
- ✅ **사용자 가치 우선**: 광고 전 레시피 추천 등 가치 제공
- ✅ **자연스러운 배치**: 콘텐츠와 어울리는 위치 선정
- ✅ **적절한 빈도**: 세션당 전면 광고 최대 3회 제한
- ✅ **선택적 노출**: 광고 스킵 옵션 제공

### 광고 배치 계획

#### 1. 전면 광고 (Interstitial)
- **타이밍**: 레시피 상세 보기 완료 후
- **조건**: 레시피를 5초 이상 확인한 경우
- **빈도**: 세션당 최대 3회
- **설정**: `.env.common`의 `ADMOB_*_INTERSTITIAL_ID` 사용

#### 2. 배너 광고 (Banner)
- **홈 화면**: 레시피 목록 하단에 배치
- **내 냉장고**: 재료 목록 하단에 배치
- **크기**: 표준 배너 (320x50)
- **설정**: `ADMOB_*_BANNER_BOTTOM_ID` 사용

#### 3. 네이티브 광고 (선택사항)
- **위치**: 레시피 목록의 3, 7번째 아이템
- **형태**: 레시피 카드와 유사한 디자인
- **설정**: `ADMOB_*_NATIVE_ID` 사용

---

## ⚖️ 구현 가능 기능 vs 개발 의견

### 즉시 구현 가능
- ✅ 홈 화면 랜덤 레시피 추천
- ✅ 재료 추가/삭제 기능
- ✅ 내 냉장고 카테고리 표시
- ✅ 재료 기반 레시피 추천
- ✅ 레시피 상세 보기
- ✅ AdMob 광고 통합
- ✅ 의견 보내기 기능

### 개발팀 의견 필요
❓ **즐겨찾기 기능**:
- 현재 API에 즐겨찾기 관련 엔드포인트가 없음
- 로컬 저장 vs 서버 저장 방식 결정 필요
- **제안**: 1차에서는 로컬 즐겨찾기로 구현, 추후 API 확장

❓ **푸시 알림**:
- 새로운 레시피 추가, 재료 만료 알림 등
- Firebase Messaging 설정 및 서버 지원 필요
- **제안**: 2차 개발 단계에서 고려

❓ **레시피 평점 시스템**:
- 사용자 레시피 평가 및 추천 개선
- 평점 API 및 사용자 인증 시스템 필요
- **제안**: 회원가입 기능과 함께 개발

---

## ✅ 최종 개발 체크리스트

### Phase 1: 기초 인프라 (2-3일)
- [ ] 세션 관리 시스템 구현
- [ ] API 클라이언트 실제 연동
- [ ] Provider 구조 API 기반 전환
- [ ] 기본 오류 처리 구현

### Phase 2: 홈 화면 (3-4일)
- [ ] 랜덤 레시피 API 연동
- [ ] 재료 추가 API 연동
- [ ] 새로고침 기능 구현
- [ ] 로딩/에러 상태 처리

### Phase 3: 내 냉장고 (2-3일)
- [ ] 내 재료 API 연동
- [ ] 카테고리 동적 로드
- [ ] 재료 삭제 기능
- [ ] 카테고리별 필터링

### Phase 4: 요리하기 (3-4일)
- [ ] 재료 기반 레시피 조회
- [ ] 레시피 목록 화면
- [ ] 레시피 상세 화면
- [ ] 외부 링크 연결

### Phase 5: 의견 보내기 (2일)
- [ ] 의견 보내기 화면
- [ ] 3가지 유형 폼 구현
- [ ] 전송 기능 및 피드백

### Phase 6: AdMob 광고 (2-3일)
- [ ] 전면 광고 구현
- [ ] 배너 광고 배치
- [ ] 광고 빈도 제어
- [ ] 사용자 경험 최적화

### Phase 7: 최종 검증 (2-3일)
- [ ] 전체 기능 테스트
- [ ] 성능 최적화
- [ ] 배포 준비
- [ ] 문서화 완료

---

## 📸 참고 화면

### 현재 화면 구조
- **스플래시 화면**: `splash_screen.dart`
- **메인 네비게이션**: `main_screen.dart` (하단 탭)
- **홈 화면**: `home_screen.dart` (재료 추가 + 추천 레시피)
- **내 냉장고**: `my_fridge_screen.dart` (재료 관리)
- **의견 보내기**: `feedback_screen.dart` (새로 구현 필요)

### 스크린샷 촬영 가이드
각 Phase 완료시 다음 화면들의 스크린샷을 촬영하여 진행 상황을 확인:

1. **홈 화면**: 랜덤 레시피 10개 표시 상태
2. **재료 추가**: 모달에서 재료 검색 및 선택
3. **내 냉장고**: 카테고리별 재료 목록 표시
4. **요리하기**: 재료 기반 레시피 추천 목록
5. **레시피 상세**: 개별 레시피 정보 화면
6. **의견 보내기**: 3가지 의견 유형 선택 화면

---

## 🎯 성공 지표

### 기능적 목표
- [ ] 재료 추가 → 레시피 추천 플로우 완전 동작
- [ ] 세션 기반 상태 관리 안정성 99% 이상
- [ ] API 응답 시간 평균 2초 이내
- [ ] 오프라인 모드 fallback 정상 동작

### 사용자 경험 목표
- [ ] 앱 시작부터 레시피 확인까지 3스텝 이내
- [ ] 광고로 인한 사용 중단 최소화
- [ ] 직관적인 재료 추가 및 관리 UI
- [ ] 네트워크 오류시 적절한 안내 메시지

**총 예상 개발 기간**: 16-22일
**우선순위**: Phase 1-4 (핵심 기능) → Phase 5-7 (부가 기능)