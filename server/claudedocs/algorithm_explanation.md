# 레시피 추천 알고리즘 설명

## 개요

레시피 추천 시스템은 **레시피 기준 매칭률** 방식을 사용합니다. 사용자가 레시피에 필요한 재료를 얼마나 가지고 있는지를 백분율로 표시합니다.

> **Note**: 이전 버전에서는 Jaccard/Cosine 유사도 알고리즘을 사용했으나, 사용자 재료가 많을수록 점수가 낮아지는 문제로 인해 레시피 기준 매칭률로 변경되었습니다. (algorithm 파라미터는 호환성을 위해 유지됩니다)

## 레시피 기준 매칭률 (현재 사용 중)

### 개념
사용자가 레시피에 필요한 재료를 얼마나 가지고 있는지를 백분율로 계산합니다.

### 수식
```
match_score = 보유 재료 수 / 레시피 전체 재료 수
```

### 예시

#### 케이스 1: 레시피 재료를 모두 보유
- 사용자 재료: {대패삼겹살, 배추}
- 레시피 재료: {대패삼겹살, 배추}
- 매칭된 재료: 2개 / 레시피 재료: 2개
- **매칭률: 2/2 = 1.0 (100%)** ✅

#### 케이스 2: 사용자가 재료를 더 많이 보유한 경우
- 사용자 재료: {대패삼겹살, 배추, 양파, 마늘, 고추}
- 레시피 재료: {대패삼겹살, 배추}
- 매칭된 재료: 2개 / 레시피 재료: 2개
- **매칭률: 2/2 = 1.0 (100%)** ✅

#### 케이스 3: 일부 재료만 보유
- 사용자 재료: {대패삼겹살}
- 레시피 재료: {대패삼겹살, 배추}
- 매칭된 재료: 1개 / 레시피 재료: 2개
- **매칭률: 1/2 = 0.5 (50%)** ⚠️

### 특징
- **장점**:
  - 직관적: "레시피를 만들 수 있는가"를 명확하게 표현
  - 사용자 재료가 많아도 점수가 낮아지지 않음
  - 레시피 완성도를 백분율로 명확히 표시
- **정렬 우선순위**:
  - 1차: 매칭률 (높은 순)
  - 2차: 매칭된 재료 수 (많은 순)

### 사용자 경험
- 100% 매칭: "지금 바로 만들 수 있어요!"
- 80% 이상: "거의 다 있어요. 재료 1-2개만 추가하세요"
- 50% 이상: "절반 정도 재료가 있어요"
- 50% 미만: "일부 재료만 있어요"

---

## 레거시: Jaccard/Cosine 알고리즘 (미사용)

> 아래 내용은 참고용입니다. 현재 시스템에서는 사용하지 않습니다.

### Jaccard Similarity (자카드 유사도)

### 개념
집합 간의 유사도를 측정하는 방법으로, 두 집합의 교집합 크기를 합집합 크기로 나눈 값입니다.

### 수식
```
Jaccard(A, B) = |A ∩ B| / |A ∪ B|
```
- A: 사용자가 가진 재료 집합
- B: 레시피에 필요한 재료 집합
- A ∩ B: 겹치는 재료 (매칭된 재료)
- A ∪ B: 전체 재료 (사용자 재료 + 레시피 재료 - 겹치는 재료)

### 예시
- 사용자 재료: {돼지고기, 배추, 두부} (3개)
- 레시피 재료: {돼지고기, 배추, 김치, 고춧가루} (4개)
- 매칭된 재료: {돼지고기, 배추} (2개)
- 전체 재료: {돼지고기, 배추, 두부, 김치, 고춧가루} (5개)
- **Jaccard 유사도: 2 / 5 = 0.4 (40%)**

### 특징
- **장점**: 직관적이고 이해하기 쉬움. 재료가 얼마나 겹치는지 명확하게 표현
- **단점**: 레시피 재료가 많을수록 유사도가 낮아지는 경향
- **적합한 경우**: 재료 개수가 비슷한 레시피 비교, 간단한 매칭

## Cosine Similarity (코사인 유사도)

### 개념
벡터 간의 각도를 이용한 유사도 측정 방법입니다. 두 벡터의 방향이 얼마나 유사한지 계산합니다.

### 수식
```
Cosine(A, B) = (A · B) / (||A|| × ||B||)
            = 매칭된 재료 수 / (√사용자_재료_수 × √레시피_재료_수)
```
- A · B: 내적 (이진 벡터이므로 매칭된 재료 수와 동일)
- ||A||: A의 크기 (√사용자가 가진 재료 수)
- ||B||: B의 크기 (√레시피 재료 수)

### 예시
- 사용자 재료: {돼지고기, 배추, 두부} (3개)
- 레시피 재료: {돼지고기, 배추, 김치, 고춧가루} (4개)
- 매칭된 재료: {돼지고기, 배추} (2개)
- **Cosine 유사도: 2 / (√3 × √4) = 2 / 3.46 = 0.577 (57.7%)**

### 특징
- **장점**: 재료 개수에 덜 민감함. 방향성(비율)을 중시
- **단점**: 수학적으로 다소 복잡함
- **적합한 경우**: 재료 개수가 크게 다른 레시피 비교, 균형잡힌 추천

## 비교

| 항목 | Jaccard | Cosine |
|------|---------|--------|
| 계산 방식 | 교집합 / 합집합 | 매칭 / √(재료1 × 재료2) |
| 직관성 | ⭐⭐⭐ 매우 직관적 | ⭐⭐ 보통 |
| 재료 개수 영향 | ⭐⭐ 많이 받음 | ⭐⭐⭐ 적게 받음 |
| 유사도 범위 | 0.0 ~ 1.0 | 0.0 ~ 1.0 |
| 기본값 권장 | ⭐⭐⭐ (기본) | ⭐⭐ |

## 실전 예시

### 케이스 1: 재료가 적은 레시피
- 사용자: {돼지고기, 양파, 마늘, 생강, 간장} (5개)
- 레시피: {돼지고기, 양파} (2개)
- 매칭: 2개

| 알고리즘 | 계산 | 결과 |
|---------|------|------|
| Jaccard | 2 / (5 + 2 - 2) = 2/5 | **0.40 (40%)** |
| Cosine | 2 / (√5 × √2) = 2/3.16 | **0.63 (63%)** |

👉 Cosine이 더 높은 점수 (재료 개수 차이를 완화)

### 케이스 2: 재료가 많은 레시피
- 사용자: {돼지고기, 양파, 마늘} (3개)
- 레시피: {돼지고기, 양파, 배추, 김치, 고춧가루, 된장, 두부, 파} (8개)
- 매칭: 2개

| 알고리즘 | 계산 | 결과 |
|---------|------|------|
| Jaccard | 2 / (3 + 8 - 2) = 2/9 | **0.22 (22%)** |
| Cosine | 2 / (√3 × √8) = 2/4.90 | **0.41 (41%)** |

👉 Cosine이 더 높은 점수 (복잡한 레시피도 추천 가능)

## 권장 사용법

### Jaccard 추천 상황
- 간단한 레시피 위주로 추천하고 싶을 때
- "내가 가진 재료로 최대한 많이 만들 수 있는 레시피" 찾기
- 재료 낭비를 최소화하고 싶을 때

### Cosine 추천 상황
- 다양한 복잡도의 레시피를 균형있게 추천하고 싶을 때
- 재료 개수가 많은 레시피도 공평하게 평가하고 싶을 때
- 좀 더 폭넓은 추천을 원할 때

## 관리자 설정 가이드

### 기본 알고리즘 선택
- **Jaccard (권장)**: 직관적이고 이해하기 쉬움. 대부분의 경우에 적합
- **Cosine**: 복잡한 레시피도 추천받고 싶은 사용자에게 적합

### 최소 매칭률 조정
- **낮음 (0.2~0.3)**: 다양한 레시피 추천, 일부 재료만 있어도 추천
- **중간 (0.4~0.5)**: 균형잡힌 추천, 절반 이상 재료 필요
- **높음 (0.6~0.8)**: 엄격한 추천, 대부분 재료 필요

알고리즘과 최소 매칭률을 조합하여 서비스 성격에 맞게 조정할 수 있습니다.
